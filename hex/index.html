<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hexadecimal 3D Stack Explorer w/ 4096’s Shell</title>
  <style>
    body { margin: 0; overflow: hidden; background: #111; color: #eee; font-family: sans-serif; }
    #controls { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); display: flex; gap:1em; z-index:10;
                 background: rgba(0,0,0,0.5); padding: .5em 1em; border-radius: 8px; }
    .digit-control { display: flex; align-items: center; }
    .digit-control button { width:1.5em; height:1.5em; font-size:1em; background:#333; color:#eee;
                             border:1px solid #555; border-radius:4px; cursor:pointer; }
    .digit-control input { width:2em; text-align:center; margin:0 .3em; background:#222; color:#0f0;
                            border:1px solid #555; border-radius:4px; font-size:1em; }
    .digit-control label { margin-left:.3em; font-size:.9em; }
    #container { width:100vw; height:100vh; }
  </style>
</head>
<body>

  <div id="controls">
    <div class="digit-control"><button id="dec3">–</button><input id="digit3" type="text" value="0" readonly><button id="inc3">+</button><label>4096’s</label></div>
    <div class="digit-control"><button id="dec2">–</button><input id="digit2" type="text" value="0" readonly><button id="inc2">+</button><label>256’s</label></div>
    <div class="digit-control"><button id="dec1">–</button><input id="digit1" type="text" value="0" readonly><button id="inc1">+</button><label>16’s</label></div>
    <div class="digit-control"><button id="dec0">–</button><input id="digit0" type="text" value="0" readonly><button id="inc0">+</button><label>1’s</label></div>
  </div>

  <div id="container"></div>

  <script type="importmap">
  {
    "imports": {
      "three":   "https://cdn.jsdelivr.net/npm/three@v0.149.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@v0.149.0/examples/jsm/"
    }
  }
  </script>

  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    // scene + camera + renderer
    const container = document.getElementById('container');
    const scene     = new THREE.Scene();
    scene.background = new THREE.Color(0x111111);

    const camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.set(30, 30, 40);
    camera.lookAt(0, 0, 0);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    container.appendChild(renderer.domElement);

    // orbit controls
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // lighting
    scene.add(new THREE.AmbientLight(0xffffff, 0.4));
    const dirLight = new THREE.DirectionalLight(0xffffff, 0.6);
    dirLight.position.set(10,20,10);
    scene.add(dirLight);

    // common geometry & materials
    const cubeSize = 0.9, spacing = 1;
    const geom = new THREE.BoxGeometry(cubeSize, cubeSize, cubeSize);
    const mat1    = new THREE.MeshLambertMaterial({ color: 0xff4444 });
    const mat16   = new THREE.MeshLambertMaterial({ color: 0x44ff44 });
    const mat256  = new THREE.MeshLambertMaterial({ color: 0x4444ff });
    const mat4096 = new THREE.MeshLambertMaterial({ color: 0xffff00 });

    // groups
    const group1    = new THREE.Group(),
          group16   = new THREE.Group(),
          group256  = new THREE.Group(),
          group4096 = new THREE.Group();
    scene.add(group1, group16, group256, group4096);

    // UI state
    const digits = [0,0,0,0];
    const txts = [
      document.getElementById('digit0'),
      document.getElementById('digit1'),
      document.getElementById('digit2'),
      document.getElementById('digit3')
    ];
    function setDisplay(i) { txts[i].value = digits[i].toString(16).toUpperCase(); }
    for (let i = 0; i < 4; i++) {
      document.getElementById(`inc${i}`).onclick = () => { if (digits[i]<15) digits[i]++; setDisplay(i); draw(); };
      document.getElementById(`dec${i}`).onclick = () => { if (digits[i]>0) digits[i]--; setDisplay(i); draw(); };
      setDisplay(i);
    }

    // draw stacks
    function draw() {
      group1.clear(); group16.clear(); group256.clear(); group4096.clear();
      const [ones, sixteens, hundreds, thousands] = digits;

      // 1’s (red)
      for (let i = 0; i < ones; i++) {
        const m = new THREE.Mesh(geom, mat1);
        m.position.set(i*spacing, 0, 0);
        group1.add(m);
      }

      // 16’s (green)
      for (let r = 0; r < sixteens; r++) {
        for (let i = 0; i < 16; i++) {
          const m = new THREE.Mesh(geom, mat16);
          m.position.set(i*spacing, r*spacing, -spacing);
          group16.add(m);
        }
      }

      // 256’s (blue)
      for (let b = 0; b < hundreds; b++) {
        for (let r = 0; r < 16; r++) {
          for (let i = 0; i < 16; i++) {
            const m = new THREE.Mesh(geom, mat256);
            m.position.set(i*spacing, r*spacing, -(2 + b)*spacing);
            group256.add(m);
          }
        }
      }

      // 4096’s shell only (yellow), front face at z = -17*spacing
      for (let block = 0; block < thousands; block++) {
        for (let z = 0; z < 16; z++) {
          for (let y = 0; y < 16; y++) {
            for (let x = 0; x < 16; x++) {
              if (x>0 && x<15 && y>0 && y<15 && z>0 && z<15) continue; // skip interior
              const m = new THREE.Mesh(geom, mat4096);
              m.position.set(
                x*spacing,
                (block*16 + y)*spacing,
                -(17 + z)*spacing    // ← pushed back behind 15 grids
              );
              group4096.add(m);
            }
          }
        }
      }
    }
    draw();

    // render loop
    (function animate() {
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
    })();
  </script>

</body>
</html>
